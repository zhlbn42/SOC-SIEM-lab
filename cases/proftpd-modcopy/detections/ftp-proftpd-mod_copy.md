# FTP ProFTPD mod_copy exploitation detection

## Goal
Detect exploitation attempts of the ProFTPD mod_copy vulnerability by
monitoring abnormal FTP commands.

## Technique
The ProFTPD mod_copy module allows file copy operations using FTP commands
`SITE CPFR` and `SITE CPTO`. These commands are rarely used in legitimate
FTP workflows and are commonly associated with exploitation attempts.

## Detection logic
The detection is based on identifying the presence of `SITE CPFR` or
`SITE CPTO` commands in FTP logs.

To reduce false positives and investigation noise, background web application
traffic generated by `read_log.php` is excluded.

## KQL


message:("SITE CPFR" or "SITE CPTO")
AND NOT message:"/chat/read_log.php"


## Severity
Critical

## Why this works
- `SITE CPFR` / `SITE CPTO` are protocol-level commands, not generic keywords
- Legitimate users rarely use these commands
- The technique directly enables unauthenticated file manipulation

## Possible false positives
- Custom FTP automation scripts using SITE commands (unlikely)
- Lab or testing environments

## Notes
This detection focuses on attacker behavior rather than source IP,
allowing it to remain effective even if the attacker changes infrastructure.